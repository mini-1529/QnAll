<html lang="ko">

<head>
  <script type="text/javascript" src="https://static.nid.naver.com/js/naverLogin_implicit-1.0.3.js" charset="utf-8"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>
  <!-- 네이버 로그인 버튼 노출 영역 -->
  <div id="naver_id_login"></div>
  <!-- //네이버 로그인 버튼 노출 영역 -->


  <!-- 네이버아디디로로그인 초기화 Script -->
  <script type="text/javascript">
    var naver_id_login = new naver_id_login("6ohvMrOWVXupwLYuwRIF", "https://qnall.kro.kr/naver_callback.html");
        naver_id_login.response_type = "code";
    var state = naver_id_login.getUniqState();
    naver_id_login.setButton("white", 2, 40);
    naver_id_login.setDomain(".service.com");
    naver_id_login.setState(state);
    naver_id_login.setPopup();
    naver_id_login.init_naver_id_login();
    
  </script>
  <!-- //네이버아디디로로그인 초기화 Script -->


  <!-- 네이버아디디로로그인 Callback페이지 처리 Script -->
  <script type="text/javascript">
    $(document).ready(function() {
      // 네이버 사용자 프로필 조회 이후 프로필 정보를 처리할 callback function
      function naverSignInCallback() {
        // naver_id_login.getProfileData('프로필항목명');
        // 프로필 항목은 개발가이드를 참고하시기 바랍니다.

        var token = naver_id_login.oauthParams.access_token;

        // 서버로 토큰 전송 (AJAX 요청)
               const endpoint = 'https://openapi.naver.com/v1/nid/agreement';

        // 요청 헤더에 Bearer 토큰을 포함하는 객체를 생성합니다.
        const headers = new Headers();
        headers.append('Authorization', `Bearer ${token}`);

        // fetch 함수를 사용하여 GET 요청을 보냅니다.
        fetch(endpoint, {
          method: 'GET',
          headers: headers
        })
        .then(response => {
          // 응답을 JSON 형식으로 파싱하여 데이터를 처리합니다.
          return response.json();
        })
        .then(data => {
          // 처리한 데이터를 출력하거나 다른 작업을 수행합니다.
          console.log(data);
        })
        .catch(error => {
          // 에러 처리
          console.error('Error:', error);
        });
      }

      // 네이버 사용자 프로필 조회
      naver_id_login.get_naver_userprofile(naverSignInCallback());
    });
  </script>
  <!-- //네이버아디디로로그인 Callback페이지 처리 Script -->
</body>

</html>
